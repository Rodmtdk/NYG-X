
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Connexion - NYG-X</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.0.24/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body class="bg-gray-900 text-white flex justify-center items-center min-h-screen">
    <div class="bg-gray-800 p-8 rounded shadow-md w-96">
        <h2 class="text-2xl mb-4 font-bold">Connexion NYG-X</h2>
        <label for="email" class="block text-sm mb-1">Email autorisé :</label>
        <input id="email" type="email" placeholder="Votre email" class="w-full p-2 rounded bg-gray-700 border border-gray-600 mb-4">
        <button id="login-btn" class="w-full bg-indigo-600 hover:bg-indigo-700 p-2 rounded">Se connecter</button>
        <div id="loading" class="hidden text-sm text-center text-gray-400 mt-2">Connexion en cours...</div>
        <div id="error" class="hidden text-sm text-center text-red-400 mt-2"></div>
    </div>

    <script>
        $(document).ready(function () {
            const emailAutorise = 'rod.mtdk.gng@gmail.com';

            $('#login-btn').click(() => {
                const email = $('#email').val().trim();
                $('#error').addClass('hidden').text('');
                
                if (!email || !email.includes('@')) {
                    $('#error').removeClass('hidden').text('Veuillez entrer un email valide.');
                    return;
                }

                if (email !== emailAutorise) {
                    $('#error').removeClass('hidden').text('Cet email n\'est pas autorisé.');
                    return;
                }

                $('#loading').removeClass('hidden');
                $('#login-btn').prop('disabled', true);

                $.post('http://localhost:3000/login', { email })
                    .done((response) => {
                        localStorage.setItem('jwtToken', response.token);
                        window.location.href = 'index.html';
                    })
                    .fail(() => {
                        $('#error').removeClass('hidden').text('Erreur serveur. Veuillez réessayer.');
                    })
                    .always(() => {
                        $('#loading').addClass('hidden');
                        $('#login-btn').prop('disabled', false);
                    });
            });
        });
    </script>
</body>
</html>